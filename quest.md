# 📚 丫亮笑長出題助手 命題系統架構與操作指南

【丫亮笑長出題助手】 是一套專為台灣 K-12 教育現場打造的智慧命題系統。我們不只是呼叫 AI 生成文字，而是將教育心理學、閱讀分級規範與素養導向評量理論，轉化為嚴謹的程式邏輯，讓 AI 成為懂教學的專業助教。

---

## 🧠 核心設計哲學 (Design Philosophy)

本系統的核心靈魂建立在三大理論基石之上：

1.  **適性化 (Adaptivity)**：基於《台灣 K-12 閱讀分級規範》，嚴格控制不同年段的識字量、語彙深度與句型結構。
2.  **素養導向 (Competency-Based)**：遵循《素養導向評量設計報告》，強調真實情境、跨領域整合與問題解決能力。
3.  **認知層次 (Bloom's Taxonomy)**：透過布魯姆分類法，確保題目由淺入深（階梯式命題），涵蓋記憶到創造的完整思維歷程。

---

## ⚙️ 核心邏輯解密 (The System Brain)

【丫亮笑長出題助手】 的大腦由三個關鍵矩陣組成，它們共同決定了 AI 的產出品質。

### 1. 適性化矩陣 (Adaptive Matrix)
*位置：`prompts/adaptive_matrix.js`*

我們針對不同學習階段定義了嚴格的語言邊界：

| 學習階段 | 年級 | 核心規則 (Rules) | 負面限制 (Constraints) |
| :--- | :--- | :--- | :--- |
| **識字萌芽期** | **1-2 (低)** | 語彙限 1000 字內。使用具象名詞。句型簡單 (主+謂+賓)。 | 🚫 禁止成語、疊字、雙重否定。🚫 禁止「下列何者錯誤」題型。 |
| **流暢閱讀期** | **3-4 (中)** | 識字量 2100 字。引入基礎成語。使用複句 (因為...所以...)。 | 🚫 避免反諷或隱喻修辭。🚫 選項字數不可差異過大。 |
| **閱讀學習期** | **5-6 (高)** | 識字量 2700 字。引入說明文與議論文。強調段落邏輯。 | 🚫 避免過度口語化。專有名詞總量管制。 |
| **抽象轉化期** | **7-9 (國中)** | 解鎖抽象詞彙 (如：體制)。論證結構 (主張+證據)。 | 🚫 誘答項需具似真性，不可一眼看穿。 |
| **學術應用期** | **10-12 (高中)** | 專業領域語言。跨文本對讀。模擬圖表描述。 | 🚫 禁止邏輯鬆散的論述。 |

### 2. 領域靈魂矩陣 (Domain Matrix)
*位置：`prompts/domain_matrix.js`*

不同學科有不同的命題靈魂，AI 會自動切換角色：

*   **語文**：強調修辭、語境辨析與真實溝通任務（如藥袋、書信）。
*   **數學**：強調邏輯推演與數據分析。答案需經過轉譯，不可直接在文中找到。
*   **自然**：強調科學探究歷程（假說、變因、數據判讀）。
*   **社會**：強調價值思辨與多方觀點衝突。

### 3. Prompt 組裝工廠 (The Factory)
*位置：`prompts/index.js` -> `getAdaptiveSystemInstruction`*

這是系統的總指揮中心，它負責將上述規則動態組裝成最終指令：

1.  **考點優先**：將老師指定的關鍵字設為 **Priority 1 (Mandatory)**，確保 AI 不脫題。
2.  **多樣性強制**：注入「不重複原則」，要求 5 題必須考 5 個不同概念。
3.  **階梯式排序**：要求題目依照 Bloom 層次 **由低到高** 排列。
4.  **品質校驗**：注入對稱選項、無極端詞等品質控管指令。

---

## 🖥️ UI 操作指南 (User Guide)

v11.0 的介面設計強調「直覺連動」與「情境揭露」。

### 1. 提供內容 (AI 生成頁籤)
*   **學習領域 (Domain)**：選擇科目（如數學）。此選項會 **全域同步** 到出題設定。
*   **學生程度 (Level)**：選擇年級（如低年級）。
    *   *智慧連動*：選擇年級後，下方的「內容篇幅」滑桿會自動跳轉至該年級的科學建議字數（如低年級 100 字）。
*   **內容篇幅 (Slider)**：
    *   **預設模式**：藍色標籤，顯示系統建議值。
    *   **自訂模式**：手動拖拉後變為粉色標籤，顯示「自訂字數」。
    *   **閱讀時間**：滑桿旁會即時顯示「預估閱讀時間」（基於該年級的平均閱讀速率）。

### 2. 生成題目 (出題設定卡片)
*   **學習領域**：與 AI 生成頁籤同步。
*   **出題風格**：
    *   **知識記憶型**：適合考定義、背誦（低年級會自動轉化為「圖文辨識」）。
    *   **素養導向型**：點選後，下方會自動展開 **「情境類型」** 選單。
*   **情境類型**：僅在素養模式下顯示。可指定情境範疇（個人生活、社會時事、跨科議題...）。

---

## 👨‍💻 開發者備註 (Developer Notes)

### 關鍵檔案結構
*   `handlers/adaptive_ui.js`：負責 UI 的全域連動邏輯 (Observer Pattern)。
*   `handlers/content.js`：負責文章生成的參數收集與 JSON 清洗 (Parser)。
*   `handlers/generator.js`：負責出題的參數收集與流程控制。
*   `prompts/index.js`：Prompt 的組裝工廠。
*   `prompts/adaptive_matrix.js`：適性化規則資料庫。
*   `prompts/domain_matrix.js`：學科領域規則資料庫。
*   `prompts/bloom_verbs.js`：認知層次動詞庫。

### 維護建議
若需調整各年級的字數預設值，請修改 `handlers/adaptive_ui.js` 中的 `WORD_COUNT_DEFAULTS` 常數。
若需調整 AI 的語氣或禁語，請修改 `prompts/adaptive_matrix.js`。

---
*Generated by 丫亮笑長練功坊 *
